<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>中原智慧社区2.0前端开发回顾 | 索洪波的网站</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="分享前端相关知识技巧、原创html特效！">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.1225f46a.css" as="style"><link rel="preload" href="/assets/js/app.711c51a4.js" as="script"><link rel="preload" href="/assets/js/3.99e9ff9d.js" as="script"><link rel="preload" href="/assets/js/1.7ab74429.js" as="script"><link rel="preload" href="/assets/js/18.7f9c2512.js" as="script"><link rel="prefetch" href="/assets/js/10.663cd797.js"><link rel="prefetch" href="/assets/js/11.f2f368a7.js"><link rel="prefetch" href="/assets/js/12.fff5b217.js"><link rel="prefetch" href="/assets/js/13.d8bd1de8.js"><link rel="prefetch" href="/assets/js/14.5a5416ab.js"><link rel="prefetch" href="/assets/js/15.357aecc6.js"><link rel="prefetch" href="/assets/js/16.08665c22.js"><link rel="prefetch" href="/assets/js/17.286208c2.js"><link rel="prefetch" href="/assets/js/19.60ba96e4.js"><link rel="prefetch" href="/assets/js/20.6deff53c.js"><link rel="prefetch" href="/assets/js/21.0bc45dae.js"><link rel="prefetch" href="/assets/js/22.da381ed6.js"><link rel="prefetch" href="/assets/js/23.56e735c4.js"><link rel="prefetch" href="/assets/js/24.42d31494.js"><link rel="prefetch" href="/assets/js/25.7593bab4.js"><link rel="prefetch" href="/assets/js/26.3caf3239.js"><link rel="prefetch" href="/assets/js/27.36dccdcc.js"><link rel="prefetch" href="/assets/js/28.bf07e4c2.js"><link rel="prefetch" href="/assets/js/29.10a6c1b5.js"><link rel="prefetch" href="/assets/js/30.b1412699.js"><link rel="prefetch" href="/assets/js/31.90ab3ecd.js"><link rel="prefetch" href="/assets/js/32.4a3c4b56.js"><link rel="prefetch" href="/assets/js/33.82119096.js"><link rel="prefetch" href="/assets/js/34.4e30de06.js"><link rel="prefetch" href="/assets/js/35.3d319434.js"><link rel="prefetch" href="/assets/js/36.4a1e3bce.js"><link rel="prefetch" href="/assets/js/37.ba3135be.js"><link rel="prefetch" href="/assets/js/38.b8bc5f20.js"><link rel="prefetch" href="/assets/js/39.2d0307b2.js"><link rel="prefetch" href="/assets/js/4.62e305ea.js"><link rel="prefetch" href="/assets/js/40.3dca8e3e.js"><link rel="prefetch" href="/assets/js/41.ad782785.js"><link rel="prefetch" href="/assets/js/42.87e7672c.js"><link rel="prefetch" href="/assets/js/43.c524bc46.js"><link rel="prefetch" href="/assets/js/44.450bc560.js"><link rel="prefetch" href="/assets/js/45.6232ef33.js"><link rel="prefetch" href="/assets/js/46.ec4d0c99.js"><link rel="prefetch" href="/assets/js/47.7c7609a2.js"><link rel="prefetch" href="/assets/js/48.5ff7fdff.js"><link rel="prefetch" href="/assets/js/49.56bd4807.js"><link rel="prefetch" href="/assets/js/5.1c6e6420.js"><link rel="prefetch" href="/assets/js/50.bd7a8360.js"><link rel="prefetch" href="/assets/js/51.77001533.js"><link rel="prefetch" href="/assets/js/52.12cdb4b1.js"><link rel="prefetch" href="/assets/js/53.edf2f8bd.js"><link rel="prefetch" href="/assets/js/54.430f5e5c.js"><link rel="prefetch" href="/assets/js/55.0c6e3e34.js"><link rel="prefetch" href="/assets/js/56.7b17826b.js"><link rel="prefetch" href="/assets/js/57.60e564bc.js"><link rel="prefetch" href="/assets/js/58.415af11e.js"><link rel="prefetch" href="/assets/js/59.f8ac7dd6.js"><link rel="prefetch" href="/assets/js/6.fe85dbe9.js"><link rel="prefetch" href="/assets/js/60.0c2bae1a.js"><link rel="prefetch" href="/assets/js/61.1f4cbffd.js"><link rel="prefetch" href="/assets/js/62.6e4b8745.js"><link rel="prefetch" href="/assets/js/63.d122cae6.js"><link rel="prefetch" href="/assets/js/64.86873551.js"><link rel="prefetch" href="/assets/js/65.fd575704.js"><link rel="prefetch" href="/assets/js/66.14a4f050.js"><link rel="prefetch" href="/assets/js/67.2127cefb.js"><link rel="prefetch" href="/assets/js/68.745d02c8.js"><link rel="prefetch" href="/assets/js/69.1db96a5f.js"><link rel="prefetch" href="/assets/js/7.9266f491.js"><link rel="prefetch" href="/assets/js/70.33019188.js"><link rel="prefetch" href="/assets/js/71.6845ad37.js"><link rel="prefetch" href="/assets/js/72.cfda4db4.js"><link rel="prefetch" href="/assets/js/73.012828b6.js"><link rel="prefetch" href="/assets/js/74.8c0e595c.js"><link rel="prefetch" href="/assets/js/75.6119257f.js"><link rel="prefetch" href="/assets/js/76.366ab02b.js"><link rel="prefetch" href="/assets/js/77.699c6c86.js"><link rel="prefetch" href="/assets/js/8.25420055.js"><link rel="prefetch" href="/assets/js/9.0ca96280.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1225f46a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>索洪波的网站</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>索洪波</span>
            
          <span data-v-64685f0e>2014 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo.jpg" alt="索洪波的网站" class="logo"> <span class="site-name">索洪波的网站</span></a> <div class="links"><!----> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      文章随笔
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/知识整理/" class="nav-link"><i class="iconfont undefined"></i>
  知识整理
</a></li><li class="dropdown-item"><!----> <a href="/categories/原创特效/" class="nav-link"><i class="iconfont undefined"></i>
  原创特效
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端工具/" class="nav-link"><i class="iconfont undefined"></i>
  前端工具
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="https://suohb.com/work.htm" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-color"></i>
  原创特效
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/message/" class="nav-link"><i class="iconfont reco-suggestion"></i>
  留言板
</a></div><div class="nav-item"><a href="https://github.com/shb190802" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="/images/logo.jpg" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    索洪波
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>59</h3> <h6 data-v-ca798c94>Article</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>15</h3> <h6 data-v-ca798c94>Tag</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      文章随笔
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/知识整理/" class="nav-link"><i class="iconfont undefined"></i>
  知识整理
</a></li><li class="dropdown-item"><!----> <a href="/categories/原创特效/" class="nav-link"><i class="iconfont undefined"></i>
  原创特效
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端工具/" class="nav-link"><i class="iconfont undefined"></i>
  前端工具
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="https://suohb.com/work.htm" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-color"></i>
  原创特效
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/message/" class="nav-link"><i class="iconfont reco-suggestion"></i>
  留言板
</a></div><div class="nav-item"><a href="https://github.com/shb190802" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>中原智慧社区2.0前端开发回顾</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>索洪波</span>
            
          <span data-v-64685f0e>2014 - </span>
          2020
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>中原智慧社区2.0前端开发回顾</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>索洪波</span></i> <i class="iconfont reco-date" data-v-3b7f5bdf><span data-v-3b7f5bdf>2019-10-31</span></i> <!----> <i class="iconfont reco-tag tags" data-v-3b7f5bdf><span class="tag-item" data-v-3b7f5bdf>开发回顾</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><br> <br> <br> <br> <table><thead><tr><th>开发时间</th> <th>前端开发者</th> <th>提交次数</th></tr></thead> <tbody><tr><td>2019年08月06日-2019年10月31日</td> <td>索洪波、卢玺、张亚亚、王威、宋伟（特别开发：李彬）</td> <td>1381</td></tr></tbody></table> <br> <br> <br> <br> <h2 id="前期准备"><a href="#前期准备" class="header-anchor">#</a> 前期准备</h2> <ul><li><p><strong>技术选型</strong></p> <ul><li>物业端（Vue + iview-admin）</li> <li>业主端（Vue + vant-ui）</li></ul></li> <li><p><strong>制定开发规范</strong></p> <ul><li>开发规范地址：<a href="https://shb190802.github.io/front-end-dev-guide/dist/" target="_blank" rel="noopener noreferrer">https://shb190802.github.io/front-end-dev-guide/dist/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li><p><strong>使用VSCode</strong></p> <ul><li>安装eslint、Prettier、Vetur等插件做代码检测和格式化</li> <li>配置vscode的setting.json</li> <li>设置统一的代码格式化风格</li></ul></li> <li><p><strong>代码质量管理</strong></p> <ul><li><p><strong>做好需求分析</strong></p> <p>从收到产品提出的需求之后，先做初步整理。然后和相关人员（提出需求的业务、前后端开发者、测试人员等）进行讨论定稿。保证需求、设计、开发统一</p></li> <li><p><strong>使用GIT管理代码</strong></p> <ol><li>master、test、dev分支做代码保护，仅支持发起合并请求</li> <li>根据teambtion上的任务ID作为分支名，对应开发者</li> <li>功能完成之后发起合并</li> <li>小步提交</li></ol></li> <li><p><strong>每日代码评审</strong></p> <p>每日下班前，小组抽出30分钟左右对代码进行评审。主要是：</p> <ol><li>同步大家工作进度</li> <li>一起分析遇到的棘手问题</li> <li>对可重复利用方法和功能进行封装</li> <li>分享今日心得</li></ol></li> <li><p><strong>编写测试代码</strong></p> <p>由于项目紧急，此项功能没有执行</p></li></ul></li> <li><p><strong>其他技术选型</strong></p> <ol><li>地图组件（考虑到业主端在微信公众号中使用，地图选择腾讯地图）</li> <li>富文本组件（使用quillEditor）
<ul><li>markdown编辑器：优势：轻量级；劣势：功能过于简单</li> <li>tinymce ：功能强大的编辑器。前期一直使用；测试时候发现，编译之后尺寸太大。弃用</li> <li>quillEditor： 功能丰富，尺寸适中</li></ul></li> <li>打印组件（lodop，功能强大且支持打印设计）</li></ol></li></ul> <br> <br> <br> <br> <h2 id="开发中"><a href="#开发中" class="header-anchor">#</a> 开发中</h2> <ul><li><p><strong>路由懒加载</strong></p> <p>为保证首屏加载速度。所有的路由必须使用懒加载</p></li> <li><p><strong>组件设计原则</strong></p> <ol><li>低耦合、高内聚</li> <li>公共组件
<ul><li>与业务无关性</li> <li>要有良好的独立性，单一职责</li> <li>放在在src/components目录下</li> <li>组件以zy-开头（例：zy-editor）</li></ul></li> <li>业务组件
<ul><li>就近存放在使用目录下</li> <li>入口清晰，引用方便</li></ul></li> <li>大驼峰命名（参照开发规范）</li></ol></li></ul> <ol start="5"><li>所有组件顶部声明组件功能及说明</li></ol> <ul><li><p><strong>安全管理</strong></p> <ul><li><p><strong>通讯数据加密</strong></p> <p>数据加密是模拟https的流程，实现前后的通讯加密处理</p> <ol><li>客户端生成RSA的公钥和私钥</li> <li>将公钥发给服务端</li> <li>服务端生成AES秘钥，使用客户端发送过来的公钥加密后返回给客户端</li> <li>之后的前后的通讯都使用AES秘钥进行加解密</li> <li>请求体加入时间戳混淆，防止重复提交</li></ol></li> <li><p><strong>权限管理</strong></p> <p>对于用户可访问的页面级按钮做到权限管理</p> <ol><li>后端在用户登录时候，缓存用户拥有的权限，并将对应权限返回给客户端</li> <li>客户端根据用户不同身份和权限，控制对应页面和按钮的显示隐藏</li> <li>接口请求期间，带上该按钮对应的按钮ID，服务端二次判断用户是否有该接口的权限</li></ol></li> <li><p><strong>预防XSS攻击</strong></p> <p>引用第三方xss库对富文本等使用到的文本进行xss过滤</p></li></ul></li> <li><p><strong>vuex使用</strong></p> <ol><li>对应后台消耗较大，前端一次请求基本不变或者变动较少内容，需存入store中（如：常用字典值、省市县信息、物业小区信息等）</li> <li>所有存入store中数据的接口请求，必须使用action</li> <li>必须使用mapGetters、mapMutations、mapActions</li> <li>mutation必须全部大写</li></ol></li> <li><p><strong>全局主题配置</strong></p> <p>项目中使用less做css预处理，主色、标题、背景、等主题颜色在设置和引用时候，必须使用全局变量</p></li> <li><p><strong>全局config</strong></p> <p>在config文件中配置一些全局配置。如：</p> <ol><li>baseUrl</li> <li>文件服务器地址</li> <li>全局正则校验</li> <li>全局错误提示</li></ol></li> <li><p><strong>全局utils</strong></p> <ol><li>常用util挂在在Vue原型上</li> <li>不常用util单独引用</li></ol></li> <li><p><strong>合作开发</strong></p> <ol><li><p>代理服务器配置</p> <p>由于项目前后端属于多人开发，在联调过程中。需要配置不同接口的不同代理服务地址</p> <ul><li>增加vue.config.local.js文件，并设置git.ignore</li> <li>vue.config.js中引用local文件，并将配置以local为基准合并</li> <li>个人开发期间使用的相关配置写在vue.config.local.js中</li></ul></li> <li><p>接口模式</p> <p>由于项目牵扯到登录、加解密、权限管理功能模块。前端增加对应的开发模式设置</p> <ol><li>nocrypt：请求和响应不加解密</li> <li>nologin：请求和响应不传用户身份用户身份</li> <li>nofilter：页面不会根据权限过滤菜单和按钮</li></ol></li></ol></li> <li><p><strong>数据mock</strong></p> <p>在拿到开发需求之后，前后端需要整理出完成功能所需的api接口。
前端静态页面开发完成，后端代码短期无法完成时候，前端需要独立mock数据，完成所有逻辑。等待后端开发完之后，直接联调。</p> <ol><li>使用koa搭建mock服务器，配合koa-router和koa-body来解析请求地址和请求体</li> <li>使用mockjs，模拟返回值</li> <li>修改mock服务端response.status，模拟各种异常情况</li></ol></li> <li><p><strong>axios封装</strong></p> <p>由于项目中使用的加解密等各种情况，为了不让每个开发者编写很多重复代码。对axios做了一些封装。</p> <ol><li>加解密流程封装在拦截器里</li> <li>拦截器中请求体混入时间戳</li> <li>封装基础的公共配置（如：header等）</li></ol></li> <li><p><strong>添加loading</strong></p> <p>所有与后端的交互，除非场景要求静默，否则必须加上loading效果</p></li> <li><p><strong>使用filter</strong></p> <p>开发中使用到很多字典值比如：支付方式、性别等。使用全局filter来显示对应文本内容</p></li> <li><p><strong>使用mixin</strong></p> <p>相似的页面会存在大量的共同代码，使用mixin能很好的减少代码量和修改难度</p></li></ul> <br> <br> <br> <br> <h2 id="优化"><a href="#优化" class="header-anchor">#</a> 优化</h2> <p>开发期间，对整体项目进行了一些优化。</p> <ul><li><p><strong>使用webpack-bundle-analyzer</strong></p> <p>使用webpack的webpack-bundle-analyzer插件，对项目所引用的外部组件进行优化。去掉体积很大，但是功能使用不多的第三方库。（tinymce就是再此步骤被优化）</p></li> <li><p><strong>适配多分辨率</strong></p> <p>设计师给出的设计图，移动端为414px、PC端为1920。我们需要将其适配多个尺寸。</p> <ul><li><p><strong>移动端</strong></p> <p>使用postcss-pxtorem插件，在构建时候，会将px值修改为rem</p></li> <li><p><strong>PC端</strong></p> <p>PC端没有使用pxtorem。使用先放大后缩放的设计。具体思路都是，将body的宽度设置为1920，然后在对根据网页宽度做缩放。</p> <ol><li>使用tranfrom</li> <li>使用zoom （由于zoom具有更好的兼容性。本项目使用zoom）</li></ol></li></ul></li> <li><p><strong>图片压缩</strong></p> <p>真的背景等大图片。使用图片压缩。</p> <ol><li>使用png-8 替换 png-32/24</li> <li>照片类使用jpeg格式并压低质量</li> <li>微信端的图片上上传，使用微信图片压缩功能</li> <li>webp由于兼容性问题，暂时不作考虑</li></ol></li> <li><p><strong>去掉preload、prefetch</strong></p> <p>preload和prefetch会在浏览器空闲时间，静默下载其他首页未引用静态资源。增加之后页面的访问体验<br>
但是静默下载默认会消耗服务端带宽，造成服务器出口带宽压力。此处删除</p></li> <li><p><strong>去掉lodash</strong></p> <p>lodash库功能强大，不过客户端仅使用其中很少一部分代码。所以替换使用的工具库，删除lodash</p></li> <li><p><strong>使用echarts.simple 代替权利echarts</strong></p> <p>由于我们使用echarts仅仅基础内容，所有引用/echarts/echarts.simple完全满足，单独需求可以自定义引用。</p></li> <li><p><strong>引用moment.min代替直接引用moment</strong></p> <p>moment默认自带了国际化，此处不需要。手动修改引用指向/moment/min/moment.min</p> <ul><li>编译报warn 可以手动在node_modules/moment/min里边新增locale文件夹来取消，不影响使用</li></ul></li> <li><p><strong>使用webpack.DllPlugin来剥离公共库</strong></p> <p>将公共库组件剥离出来，加速编译。</p> <p>此处优化作用不是特别明显，暂时放弃。</p></li> <li><p><strong>使用happypack加速编译速度</strong></p> <p>开发环境正常启动，但是build时报错，官方也没有反馈issue。暂时放弃</p></li> <li><p><strong>添加项目编译时间</strong></p> <p>每次build的时候，给项目增加一个当前编译时间。来确定项目是什么时候变异的版本。</p></li></ul> <br> <br> <br> <br> <h2 id="上线"><a href="#上线" class="header-anchor">#</a> 上线</h2> <ul><li><p><strong>设置编译模式（env）</strong></p> <p>根据不同的生产环境，设置不同的编译模式，不同的编译模式下可以使用不同的请求方式（如：baseUrl，加解密方式等）</p></li> <li><p><strong>Jenkins自动发布</strong></p> <p>配置Jenkins服务器，自动编译上传最新代码</p></li> <li><p><strong>开启gzip</strong></p> <ol><li>服务端针对js、css文件开启gzip压缩功能，但是开启压缩功能会导致服务器内向消耗。</li> <li>客户端代码在打包时候，针对js、css文件，使用compression-webpack-plugin打包出一份.gz后缀的文件，服务端配置如果存在对应的gz文件。则不再做压缩操作。直接返回gz文件</li></ol></li></ul> <br> <br> <br> <br> <h3 id="开发中的一些小分享"><a href="#开发中的一些小分享" class="header-anchor">#</a> 开发中的一些小分享</h3> <ul><li><p><strong>loading的“点点点”效果（如：进行中。。。）</strong></p> <p>经常遇到加载中需要文字后边点点点一直变化的功能。这里使用增加一个类，给类的伪元素加上动画效果。分别在25% 50% 75%处，修改伪元素的content为 。  。。 。。。</p></li> <li><p><strong>大数组合并</strong></p> <p>前端缓存了很多请求数据。如：（楼栋房间信息）。之后的接口请求到每个房间的住户、仪表、账单等信息时候。需要将其合并入房间信息的缓存数据中。<br>
此时，可以将住户、仪表、账单等转换为以houseId为主键的Object。然后遍历房间信息合并这个Object</p></li> <li><p><strong>数据扁平化</strong></p> <p>因为房间数据是一颗树节点的格式（楼栋-单元-楼层-房间）这样如果要单独修改一个房间的数据。则需要很多次的遍历。<br>
此时，将楼栋、单元、楼层、房间分别缓存一个以其ID为主键的Object。直接使用Object[key]来使用</p></li> <li><p><strong>去除生产版本console</strong></p> <p>开发中会大量使用的console来打印日志，业务上线后需要出去掉这些。两个思路：</p> <ol><li>开发时候就约定好。将console的方法做好封装。</li> <li>上线版本，重写一下console相关方法（本项目使用此方法）</li></ol></li> <li><p><strong>使用keepalive.include</strong></p> <p>keepalive在vue开发中，被我们大量使用到。但是为了防止不必要的缓存。我们使用include方法。<br>
实时监听当前显示的tag标签。将路由的name合并为数组赋值给include。这样保证关闭标签后会释放缓存、切换标签时候保留缓存。<br>
页面组件的name必须和route的name保持一致</p></li> <li><p><strong>浏览器针对input.password默认事件</strong></p> <p>浏览器会根据根对类型为password的input标签，默认选择已保存密码。<br>
本项目的处理方法。打开页面，但是未输入密码时候，密码类型为text。输入之后，再将类型修改为password</p></li> <li><p><strong>ios返回时候不会刷新页面</strong></p> <p>在业主的微信环境下。用户切换到其他页面之后，再返回回来。会导致页面莫名有些功能不可使用。本项目处理方式为。每次返回，重新loading页面。<br>
监听popstate。在离开页面时候设置标志位。返回回来之后调用reload</p></li> <li><p><strong>文本长度超出容器滚动</strong></p> <p>设计滚动组件内，文本不换行 <br></p> <p>mounted之后判断内部是否超过外部宽度，然后根据宽度设置动画时间 <br></p> <p>使用animation配合transform来拿完成滚动效果</p></li> <li><p><strong>textarea中部分内容不可编辑</strong></p> <p>使用contenteditable=&quot;true&quot;模拟一个textarea<br></p> <p>将其中不可编辑的内容单独写一个span 设置contenteditable=&quot;false&quot;<br></p> <p>监听文本内容，整体文本设置一个正则，如果发现不可修改的位置被删除，那么返回上一次修改内容。</p></li></ul></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.711c51a4.js" defer></script><script src="/assets/js/3.99e9ff9d.js" defer></script><script src="/assets/js/1.7ab74429.js" defer></script><script src="/assets/js/18.7f9c2512.js" defer></script>
  </body>
</html>
